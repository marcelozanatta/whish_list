<% content_for :head do %>
    <link href="/assets/bootstrap-treeview/bootstrap-treeview.min.css" rel="stylesheet">
<% end %>

<p id="notice"><%= notice %></p>

<h1>Product Personal Whish Lists Show</h1>
<div id="app">

<div id="tree"></div>

<table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
  <thead>
    <tr>
      <th>Nome</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
      <tr v-for="product in products">
        <td>{{product.name}}</td>
      </tr>
  </tbody>
</table>
<div>

<br>

<%= link_to 'New Product Personal Whish List', new_product_personal_whish_list_path %>

<% content_for :end_body do %>
  <script src="/assets/bootstrap-treeview/bootstrap-treeview.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

  <script>
    var app = new Vue({
      el: '#app',
      data: {
        message: 'Ol√° Vue!',
        categories: [],
        products: []
      },
      methods: {

        get_products_by_category: function(url){
          self = this;

          axios.get(url)
          .then(function (response) {
            console.log(response);
            self.products = response.data
          })
          .catch(function (error) {
            console.log(error);
          })
          .finally(function () {
          });
        }

      },
      mounted: function(){
        self = this;

        axios.get('<%= get_categories_product_personal_whish_lists_url %>')
          .then(function (response) {
            console.log(response);
            self.categories = response.data
            $('#tree').treeview({
              data: response.data,
              onNodeSelected: function(event, data) {
                console.log(data);
                app.get_products_by_category(data.href);
              } 
            });
          })
          .catch(function (error) {
            console.log(error);
          })
          .finally(function () {
          });
      }
    })

  </script>

<% end %>
